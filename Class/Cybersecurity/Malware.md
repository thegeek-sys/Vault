---
Class: "[[Cybersecurity]]"
Related:
---
---
## Introduction

>[!quote] NIST 800-83 defines malware as
>”a program that is inserted into a system usually covertly, with the intent of compromising the confidentiality, integrity, or availability of the victim’s data, applications, or operating system or otherwise annoying or disrupting the victim”

---
## Classification of malware
The malwares can be classified into two broad categories:
- based first on how it spreads or propagates to reach the desired target
- then on the actions or the payload it performs once a target is reached

But can also be classified by:
- those that need a program (parasitic code such as viruses)
- those that are independent, self-contained programs (worms, trojans and bots)
- malware that does not replicate (trojans and spam email)
- malware that does replicate (viruses and worms)

### Types of malicious software
Propagation mechanisms include:
- infection of existing content by viruses that is subsequently spread to other systems
- exploit of software vulnerabilities by worms or drive-by-downloads to allow the malware to replicate
- social engineering attacks that convince users to bypass security systems mechanisms to install trojans or to respond to phishing attacks

Payload actions performed by malware once it reaches a target system can include:
- corruption of system or data files
- theft of service/make the system a zombie agent of attack as part of a botnet
- theft of information from the system/keylogging
- hiding its presence on the system

---
## Attack kits
Initially the development and deployment of malware required considerable technical skill by software authors. But the development of virus-creation toolkits in the early 1990s and then more general attack kits in the 2000s made easier for everyone to create malware.

Toolkits are often known as *crimeware* and include a variety of propagation mechanisms and payload modules that even novices can deploy, but the problem for the defending systems comes when also variants can be generates by attacker using those same toolkits

>[!example]
>- zeus
>- angler

---
## Attack sources
Another significant malware development is the change from attackers being individuals often motivated to demonstrate their technical competence to more organized and dangerous attack sources such as:
- politically motivated attackers
- criminals
- organized crime
- organizations that sell their services to companies and nations
- national government agencies

This has significantly changed the resources available and motivation behind the rise of malware and has led to  development of a large underground economy involving the sale of attack kits and access to compromised hosts and stolen information

### Advanced Persistent Threats (APTs)
The **Advanced Persistent Threats** are well-resourced, persistent application of a wide variety of intrusion technologies and malware to selected targets (usually business or political). Those are typically attributed to state-sponsored organizations and criminal enterprises.

They differ from other types of attack by their careful target selection and stealthy intrusion efforts over extended periods. High profile attacks include Aurora, RSA, APT1, and Stuxnet

>[!info] APT characteristics
>##### Advanced
>Used by attackers of a wide variety of intrusion technologies and malware including the development of custom malware if required
>
>The individual components may not necessarily be technically advanced but are careful selected to suit the chosen target
>
>##### Persistent
>Determined application of the attacks over and extended period against the chosen target in order to maximize the change of success. A variety of attacks may be progressively applied until the target is compromised
>
>##### Threats
>Threats to the selected targets as a result of the organized, capable, and wall-funded attackers intent to compromise the specifically chosen targets.
>
>The active involvement of people in the process greatly raises the threat level from that due to automated attacks tools, and also the likelihood of successful attacks

#### APT attacks
- **aim** → varies from theft of intellectual property or security and infrastructure related data to the physical disruption of infrastructure
- **techniques used** → social engineering, spear-phishing email, drive-by-downloads from selected compromised websites likely to be visited by personnel in the target organization
- **intent** → to infect the target with sophisticated malware with multiple propagation mechanisms and payloads; once they have gained initial access to systems in the target organization a further range of attack tools are used to maintain and extend their access

---
## Viruses
A **virus** is a piece of software that infects programs and:
- modifies them to include a copy of the virus
- replicates and goes on to infect other content
- easily spread through network environment

When attached to an executable program, a virus can do anything that the program is permitted to do (executes secretly when the host program is run) and they are specific to operating system and hardware

### Virus components
A virus consists of three components:
- **infection mechanism** → means by which a virus spreads or propagates (also referred to as the *infection vector*)
- **trigger** → event/condition that determines when the payload is activated or delivered (known as *logic bomb*)
- **payload** → what the virus does (besides spreading); may involve damage or benign but noticeable activity

### Virus phases
![[Pasted image 20251110143021.png]]

### Macro and scripting viruses

>[!quote] NISTIR 7298 defines a macro virus as
>“a virus that attaches itself to documents and uses the macro programming capabilities of the document’s application to execute and propagate”

Macro viruses infect scripting code used to support active content in a variety of use document types

Those can be more threatening than normal viruses for several reasons:
- is platform independent
- infect documents, not executable portions of code
- are easily spread
- because they infect user documents rather than system programs, traditional file system access controls are of limited use in preventing their spread, since users are expected to modify them
- are much easier to write or to modify than traditional executable viruses

>[!example] Melissa macro virus pseudo-code
>```
>macro Document_Open
>	disable Macro menu and some macro security features
>	if called from a user document
>		copy macro code into Normal template file
>	else
>		copy macro code into user document being opened
>	end if
>	if registry key "Melissa" not present
>		if Outlook is email client
>			for first 50 addresses in address book
>				send email to that addresses with 
>				currently infected document attached
>			end for
>		end if
>		create registry key "Melissa"
>	end if
>	if minute in hour equals day of month
>		inser text into document being opened
>	end if
>end macro
>```

### Viruses classification by target
- **boot sector infector** → infects a master boot record or boot record and spreads when a system is booted from the disk containing the virus
- **file infector** → infects files that the operating system or shell considers to be executable
- **macro virus** → infects files with macro or scripting code that is interpreted by an application
- **multipartite virus** → infects files in multiple ways

### Viruses classification by concealment strategy
- **encrypted virus** → a portion of the virus creates a random encryption key and encrypts the remainder of the virus
- **stealth virus** → a form of virus explicitly designed to hide itself from detection by anti-virus software
- **polymorphic virus** → a virus that mutates with every infection
- **metamorphic virus** → a virus that mutates and rewrites itself completely at each iteration and may change behavior as well as appearance

---
## Worms
A **worm** is a program that actively seeks out more machines to infect and each infected machine serves as an automated launching pad for attacks on other machines by exploiting software vulnerabilities in client or server programs.

It can use network connections or shared media (USB drives, CD, DVD data disks) to spread from system to system. Email worms spread in macro or script code included in attachments and instant messenger file transfer.

Upon activation the worm may replicate and propagate again and usually carries some form of payload.

>[!example]
>First known implementation was done in Xerox Palo Alto Labs in the early 1980s

### Worm replication
It can replicate in various ways:
- electronic mail or instant messenger facility → worms emails a copy of itself to other systems or sends itself as an attachment via an instant message service
- file sharing → creates a copy of itself or infects a file as a virus on removable media
- remote execution capability → worm executes a copy of itself on another system
- remote file access or transfer capability → worm uses a remote file access to transfer service to itself from one system to the other
- remote login capability → worm logs onto a remote system as a user and then uses commands to copy itself from one system to the other

### Target discovery
- **scanning** (or fingerprinting) → first function in the propagation phase for a network work; it searches for other systems to infect
- **random** → each compromised host probes random addresses in the IP address space using a different seed; this produces a high volume of Internet traffic, which may cause generalized disruption even before the actual attack is launched
- **hit-list** → the attacker first compiles a long list of potential vulnerable machines and once done, the attacker begins infecting machines on the list; each infected machine is provided with a portion of the list to scan, it results in a very short scanning period which may make it difficult to detect that infection is taking place
- **topological** → this method uses information contained on an infected victim machine to find more hosts to scan
- **local subnet** → if a host can be infected behind a firewall that host then looks for targets in its own local network; the host uses the subnet address structure to find other hosts that would otherwise be protected by the firewall

### Worm propagation model
![[Pasted image 20251110224332.png]]

