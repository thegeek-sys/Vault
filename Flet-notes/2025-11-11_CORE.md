## OpenMP
OpenMP (multi processing) is an API for shared-memory parallel programming, and is designed for shared-memory systems. System is viewed as a collection of cores or CPUs, all of which have access to main memory.

non confondere con openmpi

OpenMP aims to decompose a sequential program into components that can be executed in parallel and allows an “incremental” conversion of sequential programs into parallel ones, with the assistance of the compiler (molto meno invasivo di MPI)

OpenMP relies on compiler directives for decorating portions of the code that the compiler will attempt to parallelize.

OpenMP programs are globally sequential, locally parallel. Programs follow the fork-join paradigm:
![[Pasted image 20251111172158.png|400]]

### Pragmas
istruzioni che danno delle indicazioni al compilatore (non strettamente legato a openmp e permettono di aggiungere dei comportamenti speciali che non fanno parte dello standard C)

Pragmas are special preprocessor instructions typically added to a system to allow behaviors that aren’t part of the basic C specification.

If the compiler doesn’t support the pragmas ignore them.

```c
#pragma
```

### OpenMP pragmas

```c
#pragma omp parallel
```

Is the most basic parallel directive. The number of threads that run the following structured block of code is determined by the runtime system.

eseguire il blocco di codice successivo in parallelo

```c
#include <stdio.h>
#include <stdlib.h>
#include <omp.h>

void Hello(void);

int main(int argc, char* argv[]) {
	// get number of threads from command line
	int thread_count = strtol(argv[1], NULL, 10);
	
	#pragma omp parallel num_threads(thread_count)
	Hello();
	
	return 0;
}

void Hello(void) {
	int my_rank = omp_get_thread_num();
	int thread_count = omp_get_num_threads();
	
	printf()
}
```

sa che hello deve essere eseguita in parallelo e crea i thread e poi aspetta che tutti abbiano finito di eseguire (fa il join)
get_thread_num mio numero
get_num_threads numero totale di threads

di default esegue numero di thread uguale al numero di core disponibili
`num_threads(thread_count)` è una clausola e specifica che deve creare esttamente `thread_count` threads